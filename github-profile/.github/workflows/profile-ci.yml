name: Profile CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  workflow_dispatch:

jobs:
  validate:
    name: Validate Profile Content
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Validate README.md
        run: |
          echo "ðŸ“ Validating README.md..."
          
          if [ ! -f "README.md" ]; then
            echo "âŒ README.md not found"
            exit 1
          fi
          
          # Check for required content
          if grep -q "FAA ACTUARY MASTERYâ„¢ v2.2x" README.md; then
            echo "âœ… Title present"
          else
            echo "âŒ Title missing"
            exit 1
          fi
          
          if grep -q "PR #35 LIVE" README.md; then
            echo "âœ… PR reference present"
          else
            echo "âŒ PR reference missing"
            exit 1
          fi
          
          if grep -q "94 REPOS IMMORTALIZED" README.md; then
            echo "âœ… Repo count present"
          else
            echo "âŒ Repo count missing"
            exit 1
          fi
          
          if grep -q "PRODUCTION READY" README.md; then
            echo "âœ… Status present"
          else
            echo "âŒ Status missing"
            exit 1
          fi
          
          echo "âœ… All required content validated"
          
      - name: Validate FUNDING.yml
        run: |
          echo "ðŸ’° Validating FUNDING.yml..."
          
          if [ ! -f ".github/FUNDING.yml" ]; then
            echo "âŒ FUNDING.yml not found"
            exit 1
          fi
          
          echo "âœ… FUNDING.yml present"
          
      - name: Validate workflows
        run: |
          echo "âš™ï¸ Validating workflows..."
          
          WORKFLOW_COUNT=$(find .github/workflows -name "*.yml" | wc -l)
          echo "Found $WORKFLOW_COUNT workflows"
          
          if [ $WORKFLOW_COUNT -ge 10 ]; then
            echo "âœ… 10+ workflows deployed"
          else
            echo "âš ï¸ Expected 10+ workflows, found $WORKFLOW_COUNT"
          fi
          
      - name: Generate validation summary
        run: |
          echo "## âœ… Profile Validation Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**FAA Actuary Masteryâ„¢ v2.2x**" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Validation Results" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… README.md: Valid" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… FUNDING.yml: Valid" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… Workflows: $(find .github/workflows -name "*.yml" | wc -l) deployed" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸš€ **Status: PRODUCTION READY**" >> $GITHUB_STEP_SUMMARY
